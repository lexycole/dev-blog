
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <title>dev-blog</title>
    <link rel="stylesheet" href="/dev-blog/styles/global.css">
    <link rel="stylesheet" href="/dev-blog/highlight/default.min.css">
  </head>
  <body>
    <header>
      <nav>
        <a href="/dev-blog">dev-blog</a>
      </nav>
    </header>
    <article>
      <h1>Advanced React Patterns</h1>
<blockquote>
<p><a href="https://frontendmasters.com/courses/advanced-react-patterns/">FrontEnd Masters: Advanced React Patterns</a> 수강후 정리한 글. 강의 예제는 class형 컴포넌트로 되어있는데 Functional 컴포넌트로 예제를 수정해 정리함</p>
</blockquote>
<h2>Compound Components</h2>
<h3>Compound Components (Basic)</h3>
<p>사용하는 측에서 컴포넌트를 조합해서 사용하도록 한다. 컴포넌트의 재사용성을 높힌다.</p>
<ul>
<li>
<p>Usage</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">Usage</span> = (<span class="hljs-params">{onToggle = (on) => <span class="hljs-variable hljs-language">console</span>.log(<span class="hljs-string">'toggle:'</span> + on)}</span>) => {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{onToggle}</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.On</span>></span>The button is on<span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle.On</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.Off</span>></span>The button is off<span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle.Off</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.Button</span> /></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle</span>></span></span>
  );
}</code></pre>
</li>
<li>
<p>Implementation</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">Toggle</span> = (<span class="hljs-params">props</span>) => {
  <span class="hljs-keyword">const</span> [on, setOn] = <span class="hljs-title hljs-function">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">toggle</span> = (<span class="hljs-params"></span>) => <span class="hljs-title hljs-function">setOn</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =></span> !prev);
  <span class="hljs-title hljs-function">useEffect</span>(<span class="hljs-function">() =></span> props.<span class="hljs-title hljs-function">onToggle</span>(on), [on]);

  <span class="hljs-keyword">return</span> <span class="hljs-title hljs-class">React</span>.<span class="hljs-property">Children</span>.<span class="hljs-title hljs-function">map</span>(props.<span class="hljs-property">children</span>, <span class="hljs-function"><span class="hljs-params">child</span> =></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title hljs-class">React</span>.<span class="hljs-title hljs-function">cloneElement</span>(child, {
      on,
      toggle,
    });
  });
}

<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">On</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">on</span> ? props.<span class="hljs-property">children</span> : <span class="hljs-literal">null</span>;
}
<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">Off</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">on</span> ? <span class="hljs-literal">null</span> : props.<span class="hljs-property">children</span>;
}
<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">Button</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Switch</span> <span class="hljs-attr">on</span>=<span class="hljs-string">{props.on}</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{props.toggle}/</span>></span></span>;
}</code></pre>
</li>
</ul>
<h3>Compound Component (Context API)</h3>
<p>Context API 를 이용하는 방법</p>
<ul>
<li>
<p>Usage</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">Usage</span> = (<span class="hljs-params">{onToggle = (on) => <span class="hljs-variable hljs-language">console</span>.log(<span class="hljs-string">'toggle:'</span> + on)}</span>) => {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{onToggle}</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.On</span>></span>The button is on<span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle.On</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.Off</span>></span>The button is off<span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle.Off</span>></span>
      <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle.Button</span> /></span>
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle</span>></span></span>
  );
}</code></pre>
</li>
<li>
<p>Implementation</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> <span class="hljs-title hljs-class">ToggleContext</span> = <span class="hljs-title hljs-class">React</span>.<span class="hljs-title hljs-function">createContext</span>({<span class="hljs-attr">on</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">toggle</span>: <span class="hljs-function">() =></span> {}});

<span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">Toggle</span> = (<span class="hljs-params">props</span>) => {
  <span class="hljs-keyword">const</span> [on, setOn] = <span class="hljs-title hljs-function">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">toggle</span> = (<span class="hljs-params"></span>) => <span class="hljs-title hljs-function">setOn</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =></span> !prev);
  <span class="hljs-title hljs-function">useEffect</span>(<span class="hljs-function">() =></span> props.<span class="hljs-title hljs-function">onToggle</span>(on), [on]);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ToggleContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{on,</span> <span class="hljs-attr">toggle</span>}}></span>
    {props.children}
  <span class="hljs-tag">&#x3C;/<span class="hljs-name">ToggleContext.Provider</span>></span></span>;
}

<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">On</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ToggleContext.Consumer</span>></span>
  {({on}) => (on ? props.children : null)}
<span class="hljs-tag">&#x3C;/<span class="hljs-name">ToggleContext.Consumer</span>></span></span>;

<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">Off</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ToggleContext.Consumer</span>></span>
  {({on}) => (on ? null : props.children)}
<span class="hljs-tag">&#x3C;/<span class="hljs-name">ToggleContext.Consumer</span>></span></span>;

<span class="hljs-title hljs-class">Toggle</span>.<span class="hljs-property">Button</span> = <span class="hljs-function">(<span class="hljs-params">props</span>) =></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ToggleContext.Consumer</span>></span>
  {({on, toggle}) => <span class="hljs-tag">&#x3C;<span class="hljs-name">Switch</span>  {<span class="hljs-attr">...props</span>} <span class="hljs-attr">on</span>=<span class="hljs-string">{on}</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggle}</span> /></span>}
<span class="hljs-tag">&#x3C;/<span class="hljs-name">ToggleContext.Consumer</span>></span></span></code></pre>
</li>
</ul>
<h2>Render Props</h2>
<p>자식 컴포넌트로 render 함수를 사용할 수 있도록 한다.
render 함수의 인자로는 사용자가 필요한 상태값과 상태를 변경할 수 있는 액션 함수를 제공한다.</p>
<ul>
<li>
<p>Usage</p>
<pre><code class="hljs language-jsx"><span class="hljs-keyword">const</span> <span class="hljs-title hljs-function">Usage</span> = (<span class="hljs-params">props</span>) => {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Toggle</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{props.onToggle}</span>></span>
      {
        ({on, toggle}) => (
          <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
            { on ? 'This button is on' : 'This button is off'}
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Switch</span> <span class="hljs-attr">on</span>=<span class="hljs-string">{on}</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggle}</span>></span>
          <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
        )
      }
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">Toggle</span>></span>
}</span></code></pre>
</li>
<li>
<p>Implementation</p>
<pre><code class="hljs language-jsx"><span class="hljs-comment">// TODO</span></code></pre>
</li>
</ul>
<h2>Controlling State</h2>
<h2>Provider Pattern</h2>

    </article>
  </body>
</html>
